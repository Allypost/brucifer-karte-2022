{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\n\nconst typeFinder = value => value instanceof Array ? \"array\" : value instanceof Object ? \"object\" : false;\n\nconst collectionValidator = collection => {\n  return collection.reduce((a, c) => {\n    if (a === null) {\n      return typeFinder(c);\n    } else {\n      return typeFinder(c) === a ? a : false;\n    }\n  }, null);\n};\n\nvar script = {\n  inject: [\"getWorkbook\", \"addSheet\", \"deleteSheet\"],\n  props: {\n    sheetName: {\n      type: String,\n      required: true\n    },\n    collection: {\n      type: Array,\n      default: null,\n\n      validator(value) {\n        if (value && value.length > 0) {\n          const type = collectionValidator(value);\n          return [\"array\", \"object\"].includes(type);\n        }\n\n        return true;\n      }\n\n    }\n  },\n\n  data() {\n    return {\n      libLoaded: false\n    };\n  },\n\n  computed: {\n    readyToParse() {\n      return this.libLoaded ? this.collection : null;\n    }\n\n  },\n  watch: {\n    readyToParse: {\n      immediate: true,\n\n      handler(collection) {\n        if (collection) {\n          this.parseCollection(collection);\n        }\n      }\n\n    }\n  },\n\n  mounted() {\n    this.load();\n  },\n\n  beforeDestroy() {\n    this.deleteSheet(this.sheetName);\n  },\n\n  methods: {\n    async load() {\n      const {\n        utils: {\n          aoa_to_sheet,\n          json_to_sheet\n        }\n      } = await import('xlsx');\n      this._aoa_to_sheet = aoa_to_sheet;\n      this._json_to_sheet = json_to_sheet;\n      this.libLoaded = true;\n      this.getWorkbook(wb => {\n        this._workbook = wb;\n      });\n    },\n\n    parseCollection(collection) {\n      const type = typeFinder(collection[0]);\n      const lib = {\n        array: this._aoa_to_sheet,\n        object: this._json_to_sheet\n      };\n      this._sheet = lib[type](collection, this.options);\n      this.$emit(\"parsed\", this._sheet);\n      this.addSheet(this._sheet, this.sheetName);\n    }\n\n  },\n\n  render(h) {\n    if (this.$slots.default && this.libLoaded) {\n      return h(\"div\", this.$slots.default);\n    }\n\n    return null;\n  }\n\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n/* script */\n\nconst __vue_script__ = script;\n/* template */\n\n/* style */\n\nconst __vue_inject_styles__ = undefined;\n/* scoped */\n\nconst __vue_scope_id__ = undefined;\n/* module identifier */\n\nconst __vue_module_identifier__ = undefined;\n/* functional template */\n\nconst __vue_is_functional_template__ = undefined;\n/* style inject */\n\n/* style inject SSR */\n\nvar XlsxSheet = normalizeComponent_1({}, __vue_inject_styles__, __vue_script__, __vue_scope_id__, __vue_is_functional_template__, __vue_module_identifier__, undefined, undefined);\nexport default XlsxSheet;","map":{"version":3,"names":["typeFinder","value","Array","Object","collectionValidator","collection","reduce","a","c","script","inject","props","sheetName","type","String","required","default","validator","length","includes","data","libLoaded","computed","readyToParse","watch","immediate","handler","parseCollection","mounted","load","beforeDestroy","deleteSheet","methods","utils","aoa_to_sheet","json_to_sheet","_aoa_to_sheet","_json_to_sheet","getWorkbook","wb","_workbook","lib","array","object","_sheet","options","$emit","addSheet","render","h","$slots","normalizeComponent","template","style","scopeId","isFunctionalTemplate","moduleIdentifier","shadowMode","createInjector","createInjectorSSR","createInjectorShadow","staticRenderFns","_compiled","functional","_scopeId","hook","context","$vnode","ssrContext","parent","__VUE_SSR_CONTEXT__","call","_registeredComponents","add","_ssrRegister","$root","$options","shadowRoot","originalRender","renderWithStyleInjection","existing","beforeCreate","concat","normalizeComponent_1","__vue_script__","__vue_inject_styles__","undefined","__vue_scope_id__","__vue_module_identifier__","__vue_is_functional_template__","XlsxSheet"],"sources":["C:/brucifer-karte/brucifer-karte/bfk2/brucifer/ui/node_modules/vue-xlsx/dist/components/XlsxSheet.js"],"sourcesContent":["const typeFinder = value =>\n  value instanceof Array ? \"array\" : value instanceof Object ? \"object\" : false;\n\nconst collectionValidator = collection => {\n  return collection.reduce((a, c) => {\n    if (a === null) {\n      return typeFinder(c);\n    } else {\n      return typeFinder(c) === a ? a : false;\n    }\n  }, null);\n};\n\nvar script = {\n  inject: [\"getWorkbook\", \"addSheet\", \"deleteSheet\"],\n  props: {\n    sheetName: {\n      type: String,\n      required: true\n    },\n    collection: {\n      type: Array,\n      default: null,\n      validator(value) {\n        if (value && value.length > 0) {\n          const type = collectionValidator(value);\n          return [\"array\", \"object\"].includes(type);\n        }\n        return true;\n      }\n    }\n  },\n  data() {\n    return {\n      libLoaded: false\n    };\n  },\n  computed: {\n    readyToParse() {\n      return this.libLoaded ? this.collection : null;\n    }\n  },\n  watch: {\n    readyToParse: {\n      immediate: true,\n      handler(collection) {\n        if (collection) {\n          this.parseCollection(collection);\n        }\n      }\n    }\n  },\n  mounted() {\n    this.load();\n  },\n  beforeDestroy() {\n    this.deleteSheet(this.sheetName);\n  },\n  methods: {\n    async load() {\n      const {\n        utils: { aoa_to_sheet, json_to_sheet }\n      } = await import('xlsx');\n      this._aoa_to_sheet = aoa_to_sheet;\n      this._json_to_sheet = json_to_sheet;\n      this.libLoaded = true;\n      this.getWorkbook(wb => {\n        this._workbook = wb;\n      });\n    },\n    parseCollection(collection) {\n      const type = typeFinder(collection[0]);\n      const lib = {\n        array: this._aoa_to_sheet,\n        object: this._json_to_sheet\n      };\n      this._sheet = lib[type](collection, this.options);\n      this.$emit(\"parsed\", this._sheet);\n      this.addSheet(this._sheet, this.sheetName);\n    }\n  },\n  render(h) {\n    if (this.$slots.default && this.libLoaded) {\n      return h(\"div\", this.$slots.default);\n    }\n    return null;\n  }\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n\n/* script */\nconst __vue_script__ = script;\n\n/* template */\n\n  /* style */\n  const __vue_inject_styles__ = undefined;\n  /* scoped */\n  const __vue_scope_id__ = undefined;\n  /* module identifier */\n  const __vue_module_identifier__ = undefined;\n  /* functional template */\n  const __vue_is_functional_template__ = undefined;\n  /* style inject */\n  \n  /* style inject SSR */\n  \n\n  \n  var XlsxSheet = normalizeComponent_1(\n    {},\n    __vue_inject_styles__,\n    __vue_script__,\n    __vue_scope_id__,\n    __vue_is_functional_template__,\n    __vue_module_identifier__,\n    undefined,\n    undefined\n  );\n\nexport default XlsxSheet;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}