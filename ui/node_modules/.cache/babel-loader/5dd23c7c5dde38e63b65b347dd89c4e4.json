{"ast":null,"code":"var WorkbookHandler = {\n  data() {\n    return {\n      libLoaded: false,\n      loading: false\n    };\n  },\n\n  provide() {\n    return {\n      getWorkbook: this.getWorkbook\n    };\n  },\n\n  methods: {\n    startLoading() {\n      this.loading = true;\n      this.$emit(\"loading\", this.loading);\n    },\n\n    endLoading() {\n      this.loading = false;\n      this.$emit(\"loading\", this.loading);\n    },\n\n    fireCallBacks() {\n      if (this._callbackQueue && Array.isArray(this._callbackQueue)) {\n        this._callbackQueue.forEach(cb => {\n          try {\n            cb(this._workbook);\n          } catch (e) {\n            console.warning(\"error in firing callbacks\", e);\n          }\n        });\n      }\n    },\n\n    getWorkbook(cb) {\n      if (this._callbackQueue) {\n        this._callbackQueue.push(cb);\n      }\n\n      if (this._workbook) {\n        cb(this._workbook);\n      }\n    }\n\n  }\n};\nvar script = {\n  mixins: [WorkbookHandler],\n\n  provide() {\n    return {\n      addSheet: this.addSheet,\n      deleteSheet: this.deleteSheet\n    };\n  },\n\n  mounted() {\n    this.load();\n  },\n\n  methods: {\n    async load() {\n      const {\n        globalPolyfill\n      } = require(\"../polyfills\");\n\n      globalPolyfill();\n      const {\n        utils: {\n          book_new,\n          book_append_sheet\n        }\n      } = await import('xlsx');\n      this._book_new = book_new;\n      this._book_append_sheet = book_append_sheet;\n      this._workbook = this._book_new();\n      this.$emit(\"created\", this._workbook);\n      this.libLoaded = true;\n    },\n\n    addSheet(sheet, sheetName) {\n      if (this._workbook) {\n        this.deleteSheet(sheetName);\n\n        this._book_append_sheet(this._workbook, sheet, sheetName);\n\n        this.$emit(\"change\", this._workbook);\n      }\n    },\n\n    deleteSheet(sheetName) {\n      if (this._workbook && this._workbook.Sheets[sheetName]) {\n        this._workbook.SheetNames = this._workbook.SheetNames.filter(s => s !== sheetName);\n        this._workbook.Sheets[sheetName] = undefined;\n        this.$emit(\"change\", this._workbook);\n      }\n    }\n\n  },\n\n  render(h) {\n    if (this.$slots.default && this.libLoaded) {\n      return h(\"div\", this.$slots.default);\n    }\n\n    return null;\n  }\n\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n/* script */\n\nconst __vue_script__ = script;\n/* template */\n\n/* style */\n\nconst __vue_inject_styles__ = undefined;\n/* scoped */\n\nconst __vue_scope_id__ = undefined;\n/* module identifier */\n\nconst __vue_module_identifier__ = undefined;\n/* functional template */\n\nconst __vue_is_functional_template__ = undefined;\n/* style inject */\n\n/* style inject SSR */\n\nvar XlsxWorkbook = normalizeComponent_1({}, __vue_inject_styles__, __vue_script__, __vue_scope_id__, __vue_is_functional_template__, __vue_module_identifier__, undefined, undefined);\nexport default XlsxWorkbook;","map":{"version":3,"names":["WorkbookHandler","data","libLoaded","loading","provide","getWorkbook","methods","startLoading","$emit","endLoading","fireCallBacks","_callbackQueue","Array","isArray","forEach","cb","_workbook","e","console","warning","push","script","mixins","addSheet","deleteSheet","mounted","load","globalPolyfill","require","utils","book_new","book_append_sheet","_book_new","_book_append_sheet","sheet","sheetName","Sheets","SheetNames","filter","s","undefined","render","h","$slots","default","normalizeComponent","template","style","scopeId","isFunctionalTemplate","moduleIdentifier","shadowMode","createInjector","createInjectorSSR","createInjectorShadow","options","staticRenderFns","_compiled","functional","_scopeId","hook","context","$vnode","ssrContext","parent","__VUE_SSR_CONTEXT__","call","_registeredComponents","add","_ssrRegister","$root","$options","shadowRoot","originalRender","renderWithStyleInjection","existing","beforeCreate","concat","normalizeComponent_1","__vue_script__","__vue_inject_styles__","__vue_scope_id__","__vue_module_identifier__","__vue_is_functional_template__","XlsxWorkbook"],"sources":["C:/brucifer-karte/brucifer-karte/bfk2/brucifer/ui/node_modules/vue-xlsx/dist/components/XlsxWorkbook.js"],"sourcesContent":["var WorkbookHandler = {\n  data() {\n    return {\n      libLoaded: false,\n      loading: false\n    };\n  },\n  provide() {\n    return {\n      getWorkbook: this.getWorkbook\n    };\n  },\n  methods: {\n    startLoading() {\n      this.loading = true;\n      this.$emit(\"loading\", this.loading);\n    },\n    endLoading() {\n      this.loading = false;\n      this.$emit(\"loading\", this.loading);\n    },\n    fireCallBacks() {\n      if (this._callbackQueue && Array.isArray(this._callbackQueue)) {\n        this._callbackQueue.forEach(cb => {\n          try {\n            cb(this._workbook);\n          } catch (e) {\n            console.warning(\"error in firing callbacks\", e);\n          }\n        });\n      }\n    },\n    getWorkbook(cb) {\n      if (this._callbackQueue) {\n        this._callbackQueue.push(cb);\n      }\n      if (this._workbook) {\n        cb(this._workbook);\n      }\n    }\n  }\n};\n\nvar script = {\n  mixins: [WorkbookHandler],\n  provide() {\n    return {\n      addSheet: this.addSheet,\n      deleteSheet: this.deleteSheet\n    };\n  },\n  mounted() {\n    this.load();\n  },\n  methods: {\n    async load() {\n      const { globalPolyfill } = require(\"../polyfills\");\n      globalPolyfill();\n      const {\n        utils: { book_new, book_append_sheet }\n      } = await import('xlsx');\n      this._book_new = book_new;\n      this._book_append_sheet = book_append_sheet;\n      this._workbook = this._book_new();\n      this.$emit(\"created\", this._workbook);\n      this.libLoaded = true;\n    },\n    addSheet(sheet, sheetName) {\n      if (this._workbook) {\n        this.deleteSheet(sheetName);\n        this._book_append_sheet(this._workbook, sheet, sheetName);\n        this.$emit(\"change\", this._workbook);\n      }\n    },\n    deleteSheet(sheetName) {\n      if (this._workbook && this._workbook.Sheets[sheetName]) {\n        this._workbook.SheetNames = this._workbook.SheetNames.filter(\n          s => s !== sheetName\n        );\n        this._workbook.Sheets[sheetName] = undefined;\n        this.$emit(\"change\", this._workbook);\n      }\n    }\n  },\n  render(h) {\n    if (this.$slots.default && this.libLoaded) {\n      return h(\"div\", this.$slots.default);\n    }\n    return null;\n  }\n};\n\nfunction normalizeComponent(template, style, script, scopeId, isFunctionalTemplate, moduleIdentifier\n/* server only */\n, shadowMode, createInjector, createInjectorSSR, createInjectorShadow) {\n  if (typeof shadowMode !== 'boolean') {\n    createInjectorSSR = createInjector;\n    createInjector = shadowMode;\n    shadowMode = false;\n  } // Vue.extend constructor export interop.\n\n\n  var options = typeof script === 'function' ? script.options : script; // render functions\n\n  if (template && template.render) {\n    options.render = template.render;\n    options.staticRenderFns = template.staticRenderFns;\n    options._compiled = true; // functional template\n\n    if (isFunctionalTemplate) {\n      options.functional = true;\n    }\n  } // scopedId\n\n\n  if (scopeId) {\n    options._scopeId = scopeId;\n  }\n\n  var hook;\n\n  if (moduleIdentifier) {\n    // server build\n    hook = function hook(context) {\n      // 2.3 injection\n      context = context || // cached call\n      this.$vnode && this.$vnode.ssrContext || // stateful\n      this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext; // functional\n      // 2.2 with runInNewContext: true\n\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__;\n      } // inject component styles\n\n\n      if (style) {\n        style.call(this, createInjectorSSR(context));\n      } // register component module identifier for async chunk inference\n\n\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier);\n      }\n    }; // used by ssr in case component is cached and beforeCreate\n    // never gets called\n\n\n    options._ssrRegister = hook;\n  } else if (style) {\n    hook = shadowMode ? function () {\n      style.call(this, createInjectorShadow(this.$root.$options.shadowRoot));\n    } : function (context) {\n      style.call(this, createInjector(context));\n    };\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // register for functional component in vue file\n      var originalRender = options.render;\n\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context);\n        return originalRender(h, context);\n      };\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate;\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook];\n    }\n  }\n\n  return script;\n}\n\nvar normalizeComponent_1 = normalizeComponent;\n\n/* script */\nconst __vue_script__ = script;\n\n/* template */\n\n  /* style */\n  const __vue_inject_styles__ = undefined;\n  /* scoped */\n  const __vue_scope_id__ = undefined;\n  /* module identifier */\n  const __vue_module_identifier__ = undefined;\n  /* functional template */\n  const __vue_is_functional_template__ = undefined;\n  /* style inject */\n  \n  /* style inject SSR */\n  \n\n  \n  var XlsxWorkbook = normalizeComponent_1(\n    {},\n    __vue_inject_styles__,\n    __vue_script__,\n    __vue_scope_id__,\n    __vue_is_functional_template__,\n    __vue_module_identifier__,\n    undefined,\n    undefined\n  );\n\nexport default XlsxWorkbook;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}