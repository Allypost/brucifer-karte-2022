{"ast":null,"code":"import axios from 'axios';\nimport VueJwtDecode from 'vue-jwt-decode';\nimport store from '@/store/index.js';\nexport default {\n  components: {},\n  el: '#app',\n  computed: {\n    privilege() {\n      return store.state.privilege;\n    },\n\n    name() {\n      return store.state.name;\n    },\n\n    id() {\n      return store.state.id;\n    },\n\n    email() {\n      return store.state.email;\n    }\n\n  },\n\n  data() {\n    return {\n      resp: ''\n    };\n  },\n\n  methods: {\n    handleCredentialResponse(res) {\n      const responsePayload = VueJwtDecode.decode(res.credential);\n      console.log(\"ID: \" + responsePayload.sub);\n      console.log('Full Name: ' + responsePayload.name);\n      console.log('Given Name: ' + responsePayload.given_name);\n      console.log('Family Name: ' + responsePayload.family_name);\n      console.log(\"Image URL: \" + responsePayload.picture);\n      console.log(\"Email: \" + responsePayload.email);\n      store.commit('setId', responsePayload.sub);\n      store.commit('setName', decodeURIComponent(escape(responsePayload.name)));\n      store.commit('setEmail', responsePayload.email);\n      axios.get('http://127.0.0.1:8000/users/').then(response => {\n        this.users = response.data;\n        var ids = [];\n        var nextId = -1;\n        var registeredEmail = false;\n        this.users.forEach(element => {\n          ids.push(element.id);\n\n          if (element.email == responsePayload.email) {\n            registeredEmail = true;\n            store.commit('setPrivilege', element.privilege);\n          }\n        });\n\n        for (let index = 0; index < ids.length; index++) {\n          if (ids.includes(String(index)) == false) {\n            nextId = index;\n            break;\n          }\n        }\n\n        if (nextId == -1) {\n          nextId = ids.length;\n        }\n\n        if (!registeredEmail) {\n          axios.post('http://127.0.0.1:8000/users/', {\n            id: nextId,\n            name: decodeURIComponent(escape(responsePayload.name)),\n            email: responsePayload.email,\n            privilege: '0'\n          }, {\n            auth: {\n              username: 'paxx',\n              password: 'KSETpenisica43'\n            }\n          });\n          store.commit('setPrivilege', '0');\n        }\n\n        this.$router.push({\n          name: 'home'\n        });\n      });\n    }\n\n  },\n  mounted: function () {\n    if (!window.location.hash) {\n      window.location = window.location + '#loaded';\n      window.location.reload();\n    }\n\n    let googleScript = document.createElement('script');\n    googleScript.src = 'https://accounts.google.com/gsi/client';\n    document.head.appendChild(googleScript);\n    window.addEventListener('load', () => {\n      console.log(window.google);\n      window.google.accounts.id.initialize({\n        client_id: \"729300808359-9qt44p6ksjivnbfd981pgjbmkh4ifgcj.apps.googleusercontent.com\",\n        hd: kset.org,\n        callback: this.handleCredentialResponse\n      });\n      window.google.accounts.id.renderButton(document.getElementById(\"signin_button\"), {\n        theme: \"outline\",\n        size: \"large\"\n      } // customization attributes\n      );\n    });\n  }\n};","map":{"version":3,"mappings":"AAYA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAOC,KAAP,MAAkB,kBAAlB;AACA,eAAe;EACXC,UAAU,EAAE,EADD;EAGXC,EAAE,EAAE,MAHO;EAIXC,QAAQ,EAAE;IACVC,SAAS,GAAG;MACV,OAAOJ,KAAK,CAACK,KAAN,CAAYD,SAAnB;IACD,CAHS;;IAIVE,IAAI,GAAE;MACJ,OAAON,KAAK,CAACK,KAAN,CAAYC,IAAnB;IACD,CANS;;IAOVC,EAAE,GAAE;MACF,OAAOP,KAAK,CAACK,KAAN,CAAYE,EAAnB;IACD,CATS;;IAUVC,KAAK,GAAE;MACL,OAAOR,KAAK,CAACK,KAAN,CAAYG,KAAnB;IACF;;EAZU,CAJC;;EAkBXC,IAAI,GAAG;IACH,OAAO;MACHC,IAAI,EAAE;IADH,CAAP;EAIH,CAvBU;;EAwBXC,OAAO,EAAE;IAELC,wBAAwB,CAACC,GAAD,EAAM;MAC1B,MAAMC,eAAc,GAAIf,YAAY,CAACgB,MAAb,CAAoBF,GAAG,CAACG,UAAxB,CAAxB;MAEAC,OAAO,CAACC,GAAR,CAAY,SAASJ,eAAe,CAACK,GAArC;MACAF,OAAO,CAACC,GAAR,CAAY,gBAAgBJ,eAAe,CAACR,IAA5C;MACAW,OAAO,CAACC,GAAR,CAAY,iBAAiBJ,eAAe,CAACM,UAA7C;MACAH,OAAO,CAACC,GAAR,CAAY,kBAAkBJ,eAAe,CAACO,WAA9C;MACAJ,OAAO,CAACC,GAAR,CAAY,gBAAgBJ,eAAe,CAACQ,OAA5C;MACAL,OAAO,CAACC,GAAR,CAAY,YAAYJ,eAAe,CAACN,KAAxC;MAIAR,KAAK,CAACuB,MAAN,CAAa,OAAb,EAAsBT,eAAe,CAACK,GAAtC;MACAnB,KAAK,CAACuB,MAAN,CAAa,SAAb,EAAwBC,kBAAkB,CAACC,MAAM,CAACX,eAAe,CAACR,IAAjB,CAAP,CAA1C;MACAN,KAAK,CAACuB,MAAN,CAAa,UAAb,EAAyBT,eAAe,CAACN,KAAzC;MAIAV,KAAK,CAAC4B,GAAN,CAAU,8BAAV,EACKC,IADL,CACUC,QAAO,IAAK;QACd,KAAKC,KAAL,GAAaD,QAAQ,CAACnB,IAAtB;QAEA,IAAIqB,GAAE,GAAI,EAAV;QACA,IAAIC,MAAK,GAAI,CAAC,CAAd;QACA,IAAIC,eAAc,GAAI,KAAtB;QAGA,KAAKH,KAAL,CAAWI,OAAX,CAAmBC,OAAM,IAAK;UAC1BJ,GAAG,CAACK,IAAJ,CAASD,OAAO,CAAC3B,EAAjB;;UAEA,IAAI2B,OAAO,CAAC1B,KAAR,IAAiBM,eAAe,CAACN,KAArC,EAA4C;YACxCwB,eAAc,GAAI,IAAlB;YACAhC,KAAK,CAACuB,MAAN,CAAa,cAAb,EAA6BW,OAAO,CAAC9B,SAArC;UACJ;QACH,CAPD;;QAQA,KAAK,IAAIgC,KAAI,GAAI,CAAjB,EAAoBA,KAAI,GAAIN,GAAG,CAACO,MAAhC,EAAwCD,KAAK,EAA7C,EAAiD;UAC7C,IAAIN,GAAG,CAACQ,QAAJ,CAAaC,MAAM,CAACH,KAAD,CAAnB,KAA+B,KAAnC,EAA0C;YACtCL,MAAK,GAAIK,KAAT;YACA;UACJ;QACJ;;QAEA,IAAIL,MAAK,IAAK,CAAC,CAAf,EAAkB;UACdA,MAAK,GAAID,GAAG,CAACO,MAAb;QACJ;;QAEA,IAAI,CAACL,eAAL,EAAsB;UAClBlC,KAAK,CAAC0C,IAAN,CAAW,8BAAX,EACI;YAAEjC,EAAE,EAAEwB,MAAN;YAAczB,IAAI,EAAEkB,kBAAkB,CAACC,MAAM,CAACX,eAAe,CAACR,IAAjB,CAAP,CAAtC;YAAsEE,KAAK,EAAEM,eAAe,CAACN,KAA7F;YAAoGJ,SAAS,EAAE;UAA/G,CADJ,EAEI;YAAEqC,IAAI,EAAE;cAAEC,QAAQ,EAAE,MAAZ;cAAoBC,QAAQ,EAAE;YAA9B;UAAR,CAFJ;UAIA3C,KAAK,CAACuB,MAAN,CAAa,cAAb,EAA6B,GAA7B;QACJ;;QACA,KAAKqB,OAAL,CAAaT,IAAb,CAAkB;UAAE7B,IAAI,EAAE;QAAR,CAAlB;MACH,CApCL;IAwCJ;;EA5DK,CAxBE;EAwFXuC,OAAO,EAAE,YAAY;IAChB,IAAG,CAACC,MAAM,CAACC,QAAP,CAAgBC,IAApB,EAA0B;MAC3BF,MAAM,CAACC,QAAP,GAAkBD,MAAM,CAACC,QAAP,GAAkB,SAApC;MACAD,MAAM,CAACC,QAAP,CAAgBE,MAAhB;IACJ;;IACI,IAAIC,YAAW,GAAIC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAnB;IACAF,YAAY,CAACG,GAAb,GAAmB,wCAAnB;IACAF,QAAQ,CAACG,IAAT,CAAcC,WAAd,CAA0BL,YAA1B;IAEAJ,MAAM,CAACU,gBAAP,CAAwB,MAAxB,EAAgC,MAAM;MAClCvC,OAAO,CAACC,GAAR,CAAY4B,MAAM,CAACW,MAAnB;MACAX,MAAM,CAACW,MAAP,CAAcC,QAAd,CAAuBnD,EAAvB,CAA0BoD,UAA1B,CAAqC;QACjCC,SAAS,EAAE,0EADsB;QAEjCC,EAAE,EAAEC,IAAI,CAACC,GAFwB;QAGjCC,QAAQ,EAAE,KAAKpD;MAHkB,CAArC;MAMAkC,MAAM,CAACW,MAAP,CAAcC,QAAd,CAAuBnD,EAAvB,CAA0B0D,YAA1B,CACId,QAAQ,CAACe,cAAT,CAAwB,eAAxB,CADJ,EAEI;QAAEC,KAAK,EAAE,SAAT;QAAoBC,IAAI,EAAE;MAA1B,CAFJ,CAEyC;MAFzC;IAIH,CAZD;EAaJ;AA9GW,CAAf","names":["axios","VueJwtDecode","store","components","el","computed","privilege","state","name","id","email","data","resp","methods","handleCredentialResponse","res","responsePayload","decode","credential","console","log","sub","given_name","family_name","picture","commit","decodeURIComponent","escape","get","then","response","users","ids","nextId","registeredEmail","forEach","element","push","index","length","includes","String","post","auth","username","password","$router","mounted","window","location","hash","reload","googleScript","document","createElement","src","head","appendChild","addEventListener","google","accounts","initialize","client_id","hd","kset","org","callback","renderButton","getElementById","theme","size"],"sourceRoot":"","sources":["C:\\brucifer-karte\\brucifer-karte\\bfk2\\brucifer-karte\\ui\\src\\views\\LoginView.vue"],"sourcesContent":["<template>\r\n    <div id=\"login\">\r\n        <div class=\"row justify-content-center\">\r\n        <div class=\"col-md-8\">\r\n          <div class=\"card-header\">Login</div>\r\n          <div class=\"card-body\">\r\n        <br>\r\n        <div id=\"signin_button\"></div>\r\n    </div></div></div></div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport VueJwtDecode from 'vue-jwt-decode'\r\nimport store from '@/store/index.js';\r\nexport default {\r\n    components: {\r\n    },\r\n    el: '#app',\r\n    computed: {\r\n    privilege() {\r\n      return store.state.privilege;\r\n    },\r\n    name(){\r\n      return store.state.name;\r\n    },\r\n    id(){\r\n      return store.state.id;\r\n    },\r\n    email(){\r\n      return store.state.email;\r\n    }\r\n    },\r\n    data() {\r\n        return {\r\n            resp: '',\r\n        }\r\n\r\n    },\r\n    methods: {\r\n\r\n        handleCredentialResponse(res) {\r\n            const responsePayload = VueJwtDecode.decode(res.credential);\r\n\r\n            console.log(\"ID: \" + responsePayload.sub);\r\n            console.log('Full Name: ' + responsePayload.name);\r\n            console.log('Given Name: ' + responsePayload.given_name);\r\n            console.log('Family Name: ' + responsePayload.family_name);\r\n            console.log(\"Image URL: \" + responsePayload.picture);\r\n            console.log(\"Email: \" + responsePayload.email);\r\n\r\n           \r\n\r\n            store.commit('setId', responsePayload.sub)\r\n            store.commit('setName', decodeURIComponent(escape(responsePayload.name)));\r\n            store.commit('setEmail', responsePayload.email)\r\n\r\n            \r\n\r\n            axios.get('http://127.0.0.1:8000/users/',)\r\n                .then(response => {\r\n                    this.users = response.data;\r\n\r\n                    var ids = [];\r\n                    var nextId = -1;\r\n                    var registeredEmail = false;\r\n\r\n\r\n                    this.users.forEach(element => {\r\n                        ids.push(element.id);\r\n\r\n                        if (element.email == responsePayload.email) {\r\n                            registeredEmail = true\r\n                            store.commit('setPrivilege', element.privilege)\r\n                        }\r\n                    });\r\n                    for (let index = 0; index < ids.length; index++) {\r\n                        if (ids.includes(String(index)) == false) {\r\n                            nextId = index;\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    if (nextId == -1) {\r\n                        nextId = ids.length;\r\n                    }\r\n\r\n                    if (!registeredEmail) {\r\n                        axios.post('http://127.0.0.1:8000/users/',\r\n                            { id: nextId, name: decodeURIComponent(escape(responsePayload.name)), email: responsePayload.email, privilege: '0' },\r\n                            { auth: { username: 'paxx', password: 'KSETpenisica43' } }\r\n                        )\r\n                        store.commit('setPrivilege', '0')\r\n                    }\r\n                    this.$router.push({ name: 'home' })\r\n                })\r\n\r\n\r\n\r\n        }\r\n\r\n\r\n    },\r\n    mounted: function () {\r\n         if(!window.location.hash) {\r\n        window.location = window.location + '#loaded';\r\n        window.location.reload();\r\n    }\r\n        let googleScript = document.createElement('script');\r\n        googleScript.src = 'https://accounts.google.com/gsi/client';\r\n        document.head.appendChild(googleScript);\r\n\r\n        window.addEventListener('load', () => {\r\n            console.log(window.google);\r\n            window.google.accounts.id.initialize({\r\n                client_id: \"729300808359-9qt44p6ksjivnbfd981pgjbmkh4ifgcj.apps.googleusercontent.com\",\r\n                hd: kset.org,\r\n                callback: this.handleCredentialResponse,\r\n\r\n            });\r\n            window.google.accounts.id.renderButton(\r\n                document.getElementById(\"signin_button\"),\r\n                { theme: \"outline\", size: \"large\" }  // customization attributes\r\n            );\r\n        })\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#signin_button {\r\n    text-align: center;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}